import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,f as e}from"./app-yTaYNIfy.js";const p={},t=e(`<h1 id="pbr材质" tabindex="-1"><a class="header-anchor" href="#pbr材质" aria-hidden="true">#</a> PBR材质</h1><p>PBR就是，基于物理的渲染(physically-based rendering)。Three.js提供了两个PBR材质相关的API<strong>MeshStandardMaterial</strong>和<strong>MeshPhysicalMaterial</strong>，后者是前者的子类。</p><h2 id="pbr材质金属度和粗糙度" tabindex="-1"><a class="header-anchor" href="#pbr材质金属度和粗糙度" aria-hidden="true">#</a> PBR材质金属度和粗糙度</h2><ul><li><p>金属度属性.metalness表示材质像金属的程度, 非金属材料,如木材或石材,使用0.0,金属使用1.0。</p></li><li><p>粗糙度roughness,0.0表示平滑的镜面反射,1.0表示完全漫反射,默认0.5。</p></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">metalness</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span><span class="token comment">//金属度属性</span>
  <span class="token literal-property property">roughness</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span><span class="token comment">//表面粗糙度</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="环境贴图-envmap" tabindex="-1"><a class="header-anchor" href="#环境贴图-envmap" aria-hidden="true">#</a> 环境贴图.envMap</h2><p>对于PBR材质，如果threejs三维场景不添加任何光源，物体就是完全黑色的，你可以不添加任何光源，尝试只使用环境贴图，你会发现物体表面的颜色也能看到，这说明环境贴图其实相当于提供了物体周围环境发射或反射的光线。</p><p>环境贴图，就是一个模型周围的环境的图像，比如一间房子，房子的上下左右前后分别拍摄一张照片，就是3D空间中6个角度方向的照片。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 加载环境贴图</span>
<span class="token comment">// 加载周围环境6个方向贴图</span>
<span class="token comment">// 上下左右前后6张贴图构成一个立方体空间</span>
<span class="token comment">// &#39;px.jpg&#39;, &#39;nx.jpg&#39;：x轴正方向、负方向贴图  p:正positive  n:负negative</span>
<span class="token comment">// &#39;py.jpg&#39;, &#39;ny.jpg&#39;：y轴贴图</span>
<span class="token comment">// &#39;pz.jpg&#39;, &#39;nz.jpg&#39;：z轴贴图</span>
<span class="token keyword">const</span> textureCube <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>CubeTextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&#39;./环境贴图/环境贴图0/&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;px.jpg&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;nx.jpg&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;py.jpg&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ny.jpg&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;pz.jpg&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;nz.jpg&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">metalness</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">roughness</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
    <span class="token literal-property property">envMap</span><span class="token operator">:</span> textureCube<span class="token punctuation">,</span> <span class="token comment">//设置pbr材质环境贴图</span>
     <span class="token comment">// envMapIntensity：控制环境贴图对mesh表面影响程度, 默认值1, 设置为0.0,相当于没有环境贴图</span>
    <span class="token literal-property property">envMapIntensity</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="设置环境贴图" tabindex="-1"><a class="header-anchor" href="#设置环境贴图" aria-hidden="true">#</a> 设置环境贴图</h2><p>网格模型可以通过材质的.envMap属性设置环境贴图，如果一个gltf模型中所有的Mesh都要设置环境贴图就需要递归遍历gltf模型，给里面每个Mesh的材质设置.envMap。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;../工厂.glb&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">gltf</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 递归遍历批量设置环境贴图</span>
    gltf<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">traverse</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>isMesh<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//判断是否是网格模型</span>
            obj<span class="token punctuation">.</span>material<span class="token punctuation">.</span>envMap <span class="token operator">=</span> textureCube<span class="token punctuation">;</span> <span class="token comment">//设置环境贴图</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果你希望环境贴图影响场景中scene所有Mesh，可以通过Scene的场景环境属性.environment实现,把环境贴图对应纹理对象设置为.environment的属性值即可。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 环境贴图纹理对象textureCube作为.environment属性值,影响所有模型</span>
scene<span class="token punctuation">.</span>environment <span class="token operator">=</span> textureCube<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="meshphysicalmaterial清漆层" tabindex="-1"><a class="header-anchor" href="#meshphysicalmaterial清漆层" aria-hidden="true">#</a> MeshPhysicalMaterial清漆层</h2><p>MeshPhysicalMaterial是在MeshStandardMaterial基础上扩展出来的子类，除了继承了MeshStandardMaterial的金属度、粗糙度等属性，还新增了清漆.clearcoat、透光率.transmission、反射率.reflectivity、光泽.sheen、折射率.ior等等各种用于模拟生活中不同材质的属性。</p><p>清漆层属性<code>.clearcoat</code>可以用来模拟物体表面一层透明图层，就好比你在物体表面刷了一层透明清漆，喷了点水。.clearcoat的范围0到1，默认0。</p><p>清漆层粗糙度<code>.clearcoatRoughness</code>属性表示物体表面透明涂层<code>.clearcoat</code>对应的的粗糙度，.clearcoatRoughness的范围是为0.0至1.0。默认值为0.0。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhysicalMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">clearcoat</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span><span class="token comment">//物体表面清漆层或者说透明涂层的厚度</span>
	<span class="token literal-property property">clearcoatRoughness</span><span class="token operator">:</span> <span class="token number">0.1</span><span class="token punctuation">,</span><span class="token comment">//透明涂层表面的粗糙度</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="物理材质透光率-transmission" tabindex="-1"><a class="header-anchor" href="#物理材质透光率-transmission" aria-hidden="true">#</a> 物理材质透光率.transmission</h2><p>为了更好的模拟玻璃、半透明塑料一类的视觉效果，可以使用物理透明度<code>.transmission</code>属性代替Mesh普通透明度属性<code>.opacity</code>。</p><p>使用.transmission属性设置Mesh透明度,即便完全透射的情况下仍可保持高反射率。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> mesh <span class="token operator">=</span> gltf<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">getObjectByName</span><span class="token punctuation">(</span><span class="token string">&#39;玻璃01&#39;</span><span class="token punctuation">)</span>
mesh<span class="token punctuation">.</span>material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhysicalMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">transmission</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token comment">//玻璃材质透光率，transmission替代opacity </span>
    <span class="token literal-property property">ior</span><span class="token operator">:</span><span class="token number">1.5</span><span class="token punctuation">,</span><span class="token comment">//非金属材料的折射率从1.0到2.333。默认值为1.5。</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,23),o=[t];function c(i,l){return s(),a("div",null,o)}const d=n(p,[["render",c],["__file","PBR材质.html.vue"]]);export{d as default};
