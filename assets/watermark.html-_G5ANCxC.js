const n=JSON.parse(`{"key":"v-99dd036e","path":"/posts/other/watermark.html","title":"网页水印","lang":"zh-CN","frontmatter":{"icon":"safe","date":"2021-07-23T00:00:00.000Z","category":["CLI"],"tag":["水印"],"star":true,"sticky":true,"description":"网页水印 const waterMarkConfig = { text: 'zhangzhengyi-张正义-特勤一队-0000000-142230199999999999', opacity: 0.1, xCount: 9, yCount: 4, angle: -30 } const {innerHeight, innerWidth} = window function createWaterMark() { const {text, opacity, xCount, yCount, angle} = waterMarkConfig const canvas = document.createElement('canvas'); canvas.width = innerWidth/xCount; canvas.height = innerHeight/yCount; const ctx = canvas.getContext('2d'); ctx.clearRect(0, 0, innerWidth/xCount, innerHeight/yCount); ctx.fillStyle = '#000'; ctx.globalAlpha = opacity; ctx.font = \`16px serif\` ctx.rotate(Math.PI / 180 * angle); const textArr = text.split('-') const offsetTop = (innerHeight/yCount - textArr.length * 20)/2 for (let i = 0; i &lt; textArr.length; i++) { ctx.fillText(textArr[i], 0, offsetTop+20*i) } return canvas.toDataURL(); } const watermakr = document.createElement('div'); watermakr.className = 'watermark'; watermakr.style.backgroundImage = \`url(\${createWaterMark()})\` document.body.appendChild(watermakr); // 观察器的配置（需要观察什么变动） const config = { attributes: true, childList: true, subtree: true }; // 当观察到变动时执行的回调函数 const callback = function (mutationsList, observer) { // Use traditional 'for loops' for IE 11 for (let mutation of mutationsList) { mutation.removedNodes.forEach(function (item) { if (item === watermakr) { console.log('发现被删除') document.body.appendChild(watermakr); } }); } }; // 监听元素 const targetNode = document.body; // 创建一个观察器实例并传入回调函数 const observer = new MutationObserver(callback); // 以上述配置开始观察目标节点 observer.observe(targetNode, config);","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/fe-blog/posts/other/watermark.html"}],["meta",{"property":"og:site_name","content":"Mr.He"}],["meta",{"property":"og:title","content":"网页水印"}],["meta",{"property":"og:description","content":"网页水印 const waterMarkConfig = { text: 'zhangzhengyi-张正义-特勤一队-0000000-142230199999999999', opacity: 0.1, xCount: 9, yCount: 4, angle: -30 } const {innerHeight, innerWidth} = window function createWaterMark() { const {text, opacity, xCount, yCount, angle} = waterMarkConfig const canvas = document.createElement('canvas'); canvas.width = innerWidth/xCount; canvas.height = innerHeight/yCount; const ctx = canvas.getContext('2d'); ctx.clearRect(0, 0, innerWidth/xCount, innerHeight/yCount); ctx.fillStyle = '#000'; ctx.globalAlpha = opacity; ctx.font = \`16px serif\` ctx.rotate(Math.PI / 180 * angle); const textArr = text.split('-') const offsetTop = (innerHeight/yCount - textArr.length * 20)/2 for (let i = 0; i &lt; textArr.length; i++) { ctx.fillText(textArr[i], 0, offsetTop+20*i) } return canvas.toDataURL(); } const watermakr = document.createElement('div'); watermakr.className = 'watermark'; watermakr.style.backgroundImage = \`url(\${createWaterMark()})\` document.body.appendChild(watermakr); // 观察器的配置（需要观察什么变动） const config = { attributes: true, childList: true, subtree: true }; // 当观察到变动时执行的回调函数 const callback = function (mutationsList, observer) { // Use traditional 'for loops' for IE 11 for (let mutation of mutationsList) { mutation.removedNodes.forEach(function (item) { if (item === watermakr) { console.log('发现被删除') document.body.appendChild(watermakr); } }); } }; // 监听元素 const targetNode = document.body; // 创建一个观察器实例并传入回调函数 const observer = new MutationObserver(callback); // 以上述配置开始观察目标节点 observer.observe(targetNode, config);"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-01-24T08:46:25.000Z"}],["meta",{"property":"article:author","content":"Mr.He"}],["meta",{"property":"article:tag","content":"水印"}],["meta",{"property":"article:published_time","content":"2021-07-23T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-01-24T08:46:25.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"网页水印\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2021-07-23T00:00:00.000Z\\",\\"dateModified\\":\\"2024-01-24T08:46:25.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.He\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[],"git":{"createdTime":1706085985000,"updatedTime":1706085985000,"contributors":[{"name":"何雪斌","email":"hexuebin@megvii.com","commits":1}]},"readingTime":{"minutes":0.85,"words":254},"filePathRelative":"posts/other/watermark.md","localizedDate":"2021年7月23日","excerpt":"<h1> 网页水印</h1>\\n<div class=\\"language-jsx line-numbers-mode\\" data-ext=\\"jsx\\"><pre class=\\"language-jsx\\"><code><span class=\\"token keyword\\">const</span> waterMarkConfig <span class=\\"token operator\\">=</span> <span class=\\"token punctuation\\">{</span>\\n  <span class=\\"token literal-property property\\">text</span><span class=\\"token operator\\">:</span> <span class=\\"token string\\">'zhangzhengyi-张正义-特勤一队-0000000-142230199999999999'</span><span class=\\"token punctuation\\">,</span>\\n  <span class=\\"token literal-property property\\">opacity</span><span class=\\"token operator\\">:</span> <span class=\\"token number\\">0.1</span><span class=\\"token punctuation\\">,</span>\\n  <span class=\\"token literal-property property\\">xCount</span><span class=\\"token operator\\">:</span> <span class=\\"token number\\">9</span><span class=\\"token punctuation\\">,</span>\\n  <span class=\\"token literal-property property\\">yCount</span><span class=\\"token operator\\">:</span> <span class=\\"token number\\">4</span><span class=\\"token punctuation\\">,</span>\\n  <span class=\\"token literal-property property\\">angle</span><span class=\\"token operator\\">:</span> <span class=\\"token operator\\">-</span><span class=\\"token number\\">30</span>\\n<span class=\\"token punctuation\\">}</span>\\n<span class=\\"token keyword\\">const</span> <span class=\\"token punctuation\\">{</span>innerHeight<span class=\\"token punctuation\\">,</span> innerWidth<span class=\\"token punctuation\\">}</span> <span class=\\"token operator\\">=</span> window\\n<span class=\\"token keyword\\">function</span> <span class=\\"token function\\">createWaterMark</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n  <span class=\\"token keyword\\">const</span> <span class=\\"token punctuation\\">{</span>text<span class=\\"token punctuation\\">,</span> opacity<span class=\\"token punctuation\\">,</span> xCount<span class=\\"token punctuation\\">,</span> yCount<span class=\\"token punctuation\\">,</span> angle<span class=\\"token punctuation\\">}</span> <span class=\\"token operator\\">=</span> waterMarkConfig\\n  <span class=\\"token keyword\\">const</span> canvas <span class=\\"token operator\\">=</span> document<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">createElement</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'canvas'</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n  canvas<span class=\\"token punctuation\\">.</span>width <span class=\\"token operator\\">=</span> innerWidth<span class=\\"token operator\\">/</span>xCount<span class=\\"token punctuation\\">;</span>\\n  canvas<span class=\\"token punctuation\\">.</span>height <span class=\\"token operator\\">=</span> innerHeight<span class=\\"token operator\\">/</span>yCount<span class=\\"token punctuation\\">;</span>\\n  <span class=\\"token keyword\\">const</span> ctx <span class=\\"token operator\\">=</span> canvas<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getContext</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'2d'</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n  ctx<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">clearRect</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">0</span><span class=\\"token punctuation\\">,</span> <span class=\\"token number\\">0</span><span class=\\"token punctuation\\">,</span> innerWidth<span class=\\"token operator\\">/</span>xCount<span class=\\"token punctuation\\">,</span> innerHeight<span class=\\"token operator\\">/</span>yCount<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n  ctx<span class=\\"token punctuation\\">.</span>fillStyle <span class=\\"token operator\\">=</span> <span class=\\"token string\\">'#000'</span><span class=\\"token punctuation\\">;</span>\\n  ctx<span class=\\"token punctuation\\">.</span>globalAlpha <span class=\\"token operator\\">=</span> opacity<span class=\\"token punctuation\\">;</span>\\n  ctx<span class=\\"token punctuation\\">.</span>font <span class=\\"token operator\\">=</span> <span class=\\"token template-string\\"><span class=\\"token template-punctuation string\\">\`</span><span class=\\"token string\\">16px serif</span><span class=\\"token template-punctuation string\\">\`</span></span>\\n  ctx<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">rotate</span><span class=\\"token punctuation\\">(</span>Math<span class=\\"token punctuation\\">.</span><span class=\\"token constant\\">PI</span> <span class=\\"token operator\\">/</span> <span class=\\"token number\\">180</span> <span class=\\"token operator\\">*</span> angle<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n  <span class=\\"token keyword\\">const</span> textArr <span class=\\"token operator\\">=</span> text<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">split</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'-'</span><span class=\\"token punctuation\\">)</span>\\n  <span class=\\"token keyword\\">const</span> offsetTop <span class=\\"token operator\\">=</span> <span class=\\"token punctuation\\">(</span>innerHeight<span class=\\"token operator\\">/</span>yCount <span class=\\"token operator\\">-</span> textArr<span class=\\"token punctuation\\">.</span>length <span class=\\"token operator\\">*</span> <span class=\\"token number\\">20</span><span class=\\"token punctuation\\">)</span><span class=\\"token operator\\">/</span><span class=\\"token number\\">2</span>\\n  <span class=\\"token keyword\\">for</span> <span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">let</span> i <span class=\\"token operator\\">=</span> <span class=\\"token number\\">0</span><span class=\\"token punctuation\\">;</span> i <span class=\\"token operator\\">&lt;</span> textArr<span class=\\"token punctuation\\">.</span>length<span class=\\"token punctuation\\">;</span> i<span class=\\"token operator\\">++</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n    ctx<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">fillText</span><span class=\\"token punctuation\\">(</span>textArr<span class=\\"token punctuation\\">[</span>i<span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">,</span> <span class=\\"token number\\">0</span><span class=\\"token punctuation\\">,</span> offsetTop<span class=\\"token operator\\">+</span><span class=\\"token number\\">20</span><span class=\\"token operator\\">*</span>i<span class=\\"token punctuation\\">)</span>\\n  <span class=\\"token punctuation\\">}</span>\\n  <span class=\\"token keyword\\">return</span> canvas<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">toDataURL</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token punctuation\\">}</span>\\n<span class=\\"token keyword\\">const</span> watermakr <span class=\\"token operator\\">=</span> document<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">createElement</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'div'</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\nwatermakr<span class=\\"token punctuation\\">.</span>className <span class=\\"token operator\\">=</span> <span class=\\"token string\\">'watermark'</span><span class=\\"token punctuation\\">;</span>\\nwatermakr<span class=\\"token punctuation\\">.</span>style<span class=\\"token punctuation\\">.</span>backgroundImage <span class=\\"token operator\\">=</span> <span class=\\"token template-string\\"><span class=\\"token template-punctuation string\\">\`</span><span class=\\"token string\\">url(</span><span class=\\"token interpolation\\"><span class=\\"token interpolation-punctuation punctuation\\">\${</span><span class=\\"token function\\">createWaterMark</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token interpolation-punctuation punctuation\\">}</span></span><span class=\\"token string\\">)</span><span class=\\"token template-punctuation string\\">\`</span></span>\\ndocument<span class=\\"token punctuation\\">.</span>body<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">appendChild</span><span class=\\"token punctuation\\">(</span>watermakr<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n\\n<span class=\\"token comment\\">// 观察器的配置（需要观察什么变动）</span>\\n<span class=\\"token keyword\\">const</span> config <span class=\\"token operator\\">=</span> <span class=\\"token punctuation\\">{</span> <span class=\\"token literal-property property\\">attributes</span><span class=\\"token operator\\">:</span> <span class=\\"token boolean\\">true</span><span class=\\"token punctuation\\">,</span> <span class=\\"token literal-property property\\">childList</span><span class=\\"token operator\\">:</span> <span class=\\"token boolean\\">true</span><span class=\\"token punctuation\\">,</span> <span class=\\"token literal-property property\\">subtree</span><span class=\\"token operator\\">:</span> <span class=\\"token boolean\\">true</span> <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token comment\\">// 当观察到变动时执行的回调函数</span>\\n<span class=\\"token keyword\\">const</span> <span class=\\"token function-variable function\\">callback</span> <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">function</span> <span class=\\"token punctuation\\">(</span><span class=\\"token parameter\\">mutationsList<span class=\\"token punctuation\\">,</span> observer</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n  <span class=\\"token comment\\">// Use traditional 'for loops' for IE 11</span>\\n  <span class=\\"token keyword\\">for</span> <span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">let</span> mutation <span class=\\"token keyword\\">of</span> mutationsList<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n    mutation<span class=\\"token punctuation\\">.</span>removedNodes<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">forEach</span><span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">function</span> <span class=\\"token punctuation\\">(</span><span class=\\"token parameter\\">item</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n      <span class=\\"token keyword\\">if</span> <span class=\\"token punctuation\\">(</span>item <span class=\\"token operator\\">===</span> watermakr<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n        console<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">log</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'发现被删除'</span><span class=\\"token punctuation\\">)</span>\\n        document<span class=\\"token punctuation\\">.</span>body<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">appendChild</span><span class=\\"token punctuation\\">(</span>watermakr<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n      <span class=\\"token punctuation\\">}</span>\\n    <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n  <span class=\\"token punctuation\\">}</span>\\n<span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token comment\\">// 监听元素</span>\\n<span class=\\"token keyword\\">const</span> targetNode <span class=\\"token operator\\">=</span> document<span class=\\"token punctuation\\">.</span>body<span class=\\"token punctuation\\">;</span>\\n<span class=\\"token comment\\">// 创建一个观察器实例并传入回调函数</span>\\n<span class=\\"token keyword\\">const</span> observer <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">MutationObserver</span><span class=\\"token punctuation\\">(</span>callback<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token comment\\">// 以上述配置开始观察目标节点</span>\\nobserver<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">observe</span><span class=\\"token punctuation\\">(</span>targetNode<span class=\\"token punctuation\\">,</span> config<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{n as data};
